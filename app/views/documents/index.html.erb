<h1>CSV File Upload in Rails </h1>

<h2>Listing documents</h2>

<table class="table">
  <thead>
    <tr>
      <th>#</th>
      <th>File Name</th>
      <th>Date</th>
      <th>Download</th>
      <th>Delete</th>
    </tr>
  </thead>
  <tbody>
    <% @documents.each_with_index do |document, idx| %>
      <tr>
        <th scope="row"><%= idx + 1 %></th>
        <td><%= document.filename%></td>
        <th><%= document.created_at.strftime('%D  %R') %></th>
        <th><%= button_to 'Download', document, method: :get, class: 'btn btn-success'%></th>
        <th><%= button_to 'Destroy',  document, method: :delete, class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %></th>
      </tr>
    <% end %>
  </tbody>
</table>

<br>


<%= form_for Document.new, :html => { :multipart => true, :id => "fileupload" } do |f| %>
  <%= f.label :file, 'Upload CSV file' %>
  <%= f.file_field :file, multiple: true, name: "document[file]" %>

  <br>
  <button type="submit" class="btn btn-primary start">
    <i class="icon-upload icon-white"></i>
    <span>Start upload</span>
  </button>
<% end %>
<br>

<br>
<%= link_to 'New Document', new_document_path, class: "btn btn-success" %>


<script id="template-upload" type="text/x-tmpl">
  <div class="upload">
    {%=o.name%}
    <div class="progress"><div class="bar" style="width: 0%"></div></div>
  </div>
</script>
